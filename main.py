import pandas as pd

# JSON数据
data = {
    "version": 1.3,
    "people": [{
        "person_id": [-1],
        "pose_keypoints_2d": [266.977, 407.966, 0.83925, 239.473, 441.264, 0.851446, 208.128, 439.344, 0.828626, 206.163, 494.113, 0.828359, 255.204, 492.272, 0.387858, 270.794, 441.272, 0.852397, 284.606, 480.481, 0.751593, 241.477, 492.152, 0.529043, 245.359, 523.598, 0.547573, 225.868, 523.64, 0.54595, 0, 0, 0, 0, 0, 0, 265.005, 523.558, 0.502668, 0, 0, 0, 0, 0, 0, 259.135, 400.15, 0.93781, 0, 0, 0, 241.396, 406.014, 0.893278, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        "face_keypoints_2d": [],
        "hand_left_keypoints_2d": [],
        "hand_right_keypoints_2d": [],
        "pose_keypoints_3d": [],
        "face_keypoints_3d": [],
        "hand_left_keypoints_3d": [],
        "hand_right_keypoints_3d": []
    }, {
        "person_id": [-1],
        "pose_keypoints_2d": [1009.37, 376.646, 0.883695, 1025.17, 400.106, 0.90067, 1011.42, 400.177, 0.826997, 0, 0, 0, 0, 0, 0, 1034.93, 400.239, 0.862574, 1023.13, 433.479, 0.730146, 1001.62, 445.218, 0.70267, 1023.1, 460.956, 0.24369, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1023.15, 462.789, 0.334318, 0, 0, 0, 0, 0, 0, 1009.39, 368.912, 0.306739, 1011.43, 368.932, 0.91834, 0, 0, 0, 1027.08, 372.76, 0.888766, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        "face_keypoints_2d": [],
        "hand_left_keypoints_2d": [],
        "hand_right_keypoints_2d": [],
        "pose_keypoints_3d": [],
        "face_keypoints_3d": [],
        "hand_left_keypoints_3d": [],
        "hand_right_keypoints_3d": []
    }, {
        "person_id": [-1],
        "pose_keypoints_2d": [0, 0, 0, 1058.39, 476.618, 0.923115, 1105.37, 476.658, 0.902065, 1105.47, 537.312, 0.448103, 0, 0, 0, 1011.38, 476.502, 0.816338, 980.051, 523.511, 0.2025, 0, 0, 0, 1056.48, 607.809, 0.444921, 1087.81, 607.813, 0.432644, 0, 0, 0, 0, 0, 0, 1025.14, 605.879, 0.429034, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1087.71, 431.49, 0.949455, 1042.68, 429.532, 0.984423, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        "face_keypoints_2d": [],
        "hand_left_keypoints_2d": [],
        "hand_right_keypoints_2d": [],
        "pose_keypoints_3d": [],
        "face_keypoints_3d": [],
        "hand_left_keypoints_3d": [],
        "hand_right_keypoints_3d": []
    }, {
        "person_id": [-1],
        "pose_keypoints_2d": [588.254, 327.645, 0.895795, 588.145, 355.139, 0.942022, 568.641, 355.08, 0.897043, 564.701, 396.212, 0.850595, 574.573, 423.681, 0.871876, 605.885, 355.173, 0.88026, 611.774, 398.143, 0.895734, 588.32, 419.807, 0.868221, 586.3, 421.701, 0.81011, 572.505, 419.787, 0.810316, 572.619, 478.451, 0.882503, 580.405, 533.36, 0.811566, 601.871, 423.653, 0.797936, 599.925, 478.509, 0.854125, 590.18, 535.355, 0.864293, 586.253, 321.851, 0.915503, 594.109, 321.881, 0.866537, 574.598, 329.63, 0.698412, 601.997, 331.538, 0.778613, 592.152, 549.027, 0.776525, 601.896, 545.144, 0.829372, 588.324, 539.313, 0.66829, 578.466, 545.143, 0.702931, 572.536, 543.227, 0.782799, 584.271, 539.275, 0.675267],
        "face_keypoints_2d": [],
        "hand_left_keypoints_2d": [],
        "hand_right_keypoints_2d": [],
        "pose_keypoints_3d": [],
        "face_keypoints_3d": [],
        "hand_left_keypoints_3d": [],
        "hand_right_keypoints_3d": []
    }, {
        "person_id": [-1],
        "pose_keypoints_2d": [952.676, 425.605, 0.714273, 911.46, 460.787, 0.731219, 915.43, 462.917, 0.876508, 962.466, 521.642, 0.888002, 1009.43, 525.531, 0.304101, 901.711, 449.154, 0.708768, 0, 0, 0, 0, 0, 0, 899.708, 552.923, 0.438604, 899.779, 558.849, 0.606662, 962.415, 611.743, 0.0642852, 0, 0, 0, 893.851, 541.217, 0.339157, 0, 0, 0, 0, 0, 0, 948.802, 415.942, 0.857982, 0, 0, 0, 934.985, 421.702, 0.881639, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        "face_keypoints_2d": [],
        "hand_left_keypoints_2d": [],
        "hand_right_keypoints_2d": [],
        "pose_keypoints_3d": [],
        "face_keypoints_3d": [],
        "hand_left_keypoints_3d": [],
        "hand_right_keypoints_3d": []
    }, {
        "person_id": [-1],
        "pose_keypoints_2d": [386.49, 386.412, 0.896054, 382.518, 409.906, 0.904317, 360.991, 411.921, 0.816221, 368.792, 529.443, 0.162098, 0, 0, 0, 400.193, 402.212, 0.880103, 413.816, 445.227, 0.767004, 396.226, 441.324, 0.626919, 384.574, 464.812, 0.263218, 370.804, 466.773, 0.252317, 0, 0, 0, 0, 0, 0, 398.253, 462.918, 0.28364, 0, 0, 0, 0, 0, 0, 384.398, 382.577, 0.993716, 392.335, 382.588, 0.907395, 368.891, 384.418, 0.95532, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        "face_keypoints_2d": [],
        "hand_left_keypoints_2d": [],
        "hand_right_keypoints_2d": [],
        "pose_keypoints_3d": [],
        "face_keypoints_3d": [],
        "hand_left_keypoints_3d": [],
        "hand_right_keypoints_3d": []
    }, {
        "person_id": [-1],
        "pose_keypoints_2d": [0, 0, 0, 817.422, 413.898, 0.815949, 821.325, 415.85, 0.88672, 838.999, 447.135, 0.888671, 850.705, 437.383, 0.129918, 809.59, 411.839, 0.778021, 839.014, 439.314, 0.217762, 0, 0, 0, 805.76, 470.676, 0.760247, 809.619, 472.683, 0.749712, 805.634, 511.844, 0.285741, 776.307, 543.186, 0.0704324, 801.759, 464.876, 0.682854, 791.916, 509.823, 0.315965, 772.421, 543.162, 0.134965, 0, 0, 0, 0, 0, 0, 833.134, 394.234, 0.582416, 809.719, 386.48, 0.133328, 0, 0, 0, 0, 0, 0, 766.513, 550.999, 0.111656, 0, 0, 0, 0, 0, 0, 776.286, 543.224, 0.0834244],
        "face_keypoints_2d": [],
        "hand_left_keypoints_2d": [],
        "hand_right_keypoints_2d": [],
        "pose_keypoints_3d": [],
        "face_keypoints_3d": [],
        "hand_left_keypoints_3d": [],
        "hand_right_keypoints_3d": []
    }, {
        "person_id": [-1],
        "pose_keypoints_2d": [149.467, 447.113, 0.754789, 96.5317, 490.213, 0.79822, 112.177, 494.249, 0.799214, 180.708, 541.134, 0.829978, 227.82, 529.431, 0.744674, 80.844, 478.494, 0.782673, 47.5395, 507.884, 0.294382, 0, 0, 0, 59.2774, 596.049, 0.670215, 73.0349, 599.998, 0.672727, 0, 0, 0, 0, 0, 0, 41.6547, 590.177, 0.61453, 0, 0, 0, 0, 0, 0, 147.468, 441.296, 0.737499, 0, 0, 0, 127.842, 447.098, 0.860367, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        "face_keypoints_2d": [],
        "hand_left_keypoints_2d": [],
        "hand_right_keypoints_2d": [],
        "pose_keypoints_3d": [],
        "face_keypoints_3d": [],
        "hand_left_keypoints_3d": [],
        "hand_right_keypoints_3d": []
    }, {
        "person_id": [-1],
        "pose_keypoints_2d": [0, 0, 0, 5.39354, 525.502, 0.0599098, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5.34145, 525.596, 0.859375, 47.4998, 601.949, 0.81016, 5.35082, 621.516, 0.535889, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        "face_keypoints_2d": [],
        "hand_left_keypoints_2d": [],
        "hand_right_keypoints_2d": [],
        "pose_keypoints_3d": [],
        "face_keypoints_3d": [],
        "hand_left_keypoints_3d": [],
        "hand_right_keypoints_3d": []
    }, {
        "person_id": [-1],
        "pose_keypoints_2d": [165.043, 431.481, 0.738411, 133.803, 456.987, 0.533121, 116.089, 464.825, 0.420927, 0, 0, 0, 0, 0, 0, 151.353, 449.221, 0.760449, 170.932, 492.176, 0.761248, 178.829, 509.88, 0.62364, 131.693, 525.49, 0.139041, 127.804, 525.608, 0.0839855, 0, 0, 0, 0, 0, 0, 145.451, 525.55, 0.141149, 0, 0, 0, 0, 0, 0, 163.085, 419.775, 0.790357, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        "face_keypoints_2d": [],
        "hand_left_keypoints_2d": [],
        "hand_right_keypoints_2d": [],
        "pose_keypoints_3d": [],
        "face_keypoints_3d": [],
        "hand_left_keypoints_3d": [],
        "hand_right_keypoints_3d": []
    }, {
        "person_id": [-1],
        "pose_keypoints_2d": [1181.81, 433.457, 0.172793, 1224.95, 472.669, 0.776966, 1248.5, 462.801, 0.797935, 0, 0, 0, 0, 0, 0, 1197.55, 480.483, 0.809784, 1152.45, 537.33, 0.824744, 1119.1, 541.192, 0.155404, 1236.72, 578.44, 0.546543, 1258.22, 572.565, 0.528999, 1156.37, 570.608, 0.237954, 1181.84, 666.584, 0.169914, 1217.16, 584.337, 0.528028, 1138.74, 598.035, 0.463929, 1191.66, 680.252, 0.446533, 0, 0, 0, 1181.96, 429.547, 0.439704, 1228.86, 429.592, 0.0905906, 1197.43, 431.513, 0.944667, 1175.96, 697.918, 0.38437, 1181.87, 697.993, 0.441453, 1199.58, 682.232, 0.456063, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        "face_keypoints_2d": [],
        "hand_left_keypoints_2d": [],
        "hand_right_keypoints_2d": [],
        "pose_keypoints_3d": [],
        "face_keypoints_3d": [],
        "hand_left_keypoints_3d": [],
        "hand_right_keypoints_3d": []
    }, {
        "person_id": [-1],
        "pose_keypoints_2d": [0, 0, 0, 868.414, 413.873, 0.932254, 886.045, 415.77, 0.897749, 897.753, 447.268, 0.351784, 0, 0, 0, 852.722, 413.783, 0.78781, 0, 0, 0, 0, 0, 0, 858.614, 478.487, 0.449839, 870.343, 480.46, 0.467902, 0, 0, 0, 0, 0, 0, 846.83, 476.57, 0.453147, 0, 0, 0, 0, 0, 0, 886.064, 386.464, 0.0898027, 0, 0, 0, 885.942, 386.485, 0.864509, 864.499, 384.508, 0.18173, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        "face_keypoints_2d": [],
        "hand_left_keypoints_2d": [],
        "hand_right_keypoints_2d": [],
        "pose_keypoints_3d": [],
        "face_keypoints_3d": [],
        "hand_left_keypoints_3d": [],
        "hand_right_keypoints_3d": []
    }, {
        "person_id": [-1],
        "pose_keypoints_2d": [0, 0, 0, 453.044, 429.531, 0.854688, 478.494, 429.454, 0.838217, 490.294, 460.886, 0.291245, 0, 0, 0, 429.579, 429.569, 0.901087, 0, 0, 0, 0, 0, 0, 453.083, 505.971, 0.454259, 470.69, 505.938, 0.438527, 0, 0, 0, 0, 0, 0, 435.405, 507.871, 0.505665, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 460.985, 400.121, 0.655758, 433.495, 400.099, 0.836453, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        "face_keypoints_2d": [],
        "hand_left_keypoints_2d": [],
        "hand_right_keypoints_2d": [],
        "pose_keypoints_3d": [],
        "face_keypoints_3d": [],
        "hand_left_keypoints_3d": [],
        "hand_right_keypoints_3d": []
    }, {
        "person_id": [-1],
        "pose_keypoints_2d": [0, 0, 0, 978.007, 417.804, 0.886522, 991.838, 415.824, 0.749763, 993.853, 447.122, 0.364059, 995.737, 445.164, 0.0868057, 962.504, 419.803, 0.853384, 960.49, 445.271, 0.396323, 0, 0, 0, 968.328, 476.529, 0.604395, 980.016, 476.514, 0.579969, 0, 0, 0, 0, 0, 0, 962.348, 476.586, 0.662994, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 976.08, 400.249, 0.100798, 964.386, 398.3, 0.685596, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        "face_keypoints_2d": [],
        "hand_left_keypoints_2d": [],
        "hand_right_keypoints_2d": [],
        "pose_keypoints_3d": [],
        "face_keypoints_3d": [],
        "hand_left_keypoints_3d": [],
        "hand_right_keypoints_3d": []
    }, {
        "person_id": [-1],
        "pose_keypoints_2d": [355.153, 406.02, 0.171833, 335.458, 431.521, 0.401125, 339.478, 431.435, 0.678281, 364.897, 456.924, 0.724254, 386.483, 447.252, 0.530651, 321.819, 431.553, 0.255387, 0, 0, 0, 0, 0, 0, 337.438, 478.525, 0.050653, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 353.107, 404.056, 0.295763, 0, 0, 0, 337.563, 409.967, 0.767491, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        "face_keypoints_2d": [],
        "hand_left_keypoints_2d": [],
        "hand_right_keypoints_2d": [],
        "pose_keypoints_3d": [],
        "face_keypoints_3d": [],
        "hand_left_keypoints_3d": [],
        "hand_right_keypoints_3d": []
    }, {
        "person_id": [-1],
        "pose_keypoints_2d": [0, 0, 0, 310.028, 476.559, 0.325494, 351.135, 476.512, 0.408436, 0, 0, 0, 0, 0, 0, 288.473, 476.505, 0.182171, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        "face_keypoints_2d": [],
        "hand_left_keypoints_2d": [],
        "hand_right_keypoints_2d": [],
        "pose_keypoints_3d": [],
        "face_keypoints_3d": [],
        "hand_left_keypoints_3d": [],
        "hand_right_keypoints_3d": []
    }]
}

# 创建一个空的DataFrame
df = pd.DataFrame()
personid=0
# 遍历每个人的关键点数据
for person in data["people"]:
    pose_keypoints_2d = person["pose_keypoints_2d"]
    personid=personid+1
    # 将关键点数据拆分为X坐标、Y坐标和置信度
    x_coordinates = pose_keypoints_2d[0::3]
    y_coordinates = pose_keypoints_2d[1::3]
    confidences = pose_keypoints_2d[2::3]

    # 创建DataFrame来存储关键点数据
    person_df = pd.DataFrame({
        "personid": personid,
        "X Coordinate": x_coordinates,
        "Y Coordinate": y_coordinates,
        "Confidence": confidences
    })

    # 将人的数据添加到总的DataFrame中
    df = df.append(person_df, ignore_index=True)

# 将DataFrame保存为Excel文件
excel_writer = pd.ExcelWriter("pose_keypoints_person.xlsx", engine="openpyxl")
df.to_excel(excel_writer, index=False, sheet_name="Pose Keypoints")
excel_writer.save()

print("Excel文件已保存为 pose_keypoints_person.xlsx")
